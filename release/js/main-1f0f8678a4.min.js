angular.module("ozApp",["ui.router","ozApp.directive","ozApp.controllers","ozApp.Auth","ozApp.Config","ozApp.ConfigPlayerLvRedBag","ozApp.ConfigDrawcashAndDesc","ozApp.Websocket","ozApp.Http","ozApp.Task","ozApp.filter","ozApp.tools"]).run(["$rootScope","MyWebSock","tools",function(e,o,t){o.startWebsock(),e.loadText="加载中...",e.ShowLoading=!1,e.showNotConnectApp=!1;var n=t.GetQueryString("channelId");null!=n&&t.setCookie("channelId",n),6===t.iOSVersion()&&alert("您手机系统的版本为iOS6,版本较低，浏览体验会不佳，请升级到iOS7及以上系统来体验我们的网站，谢谢！")}]).config(["$stateProvider","$urlRouterProvider","$httpProvider","$provide",function(e,o,t,n){o.otherwise("/start"),e.state("start",{url:"/start",cache:"false",templateUrl:"tpl/start.html",controller:"startController"}).state("userindex",{url:"/userindex",cache:"false",templateUrl:"tpl/userindex.html",controller:"ozIndexController"}).state("usercenter",{url:"/usercenter",cache:"false",templateUrl:"tpl/usercenter.html",controller:"usercenter"}).state("userinfochange",{url:"/userinfochange",cache:"false",templateUrl:"tpl/userinfochange.html",controller:"userinfochange"}).state("taskdetail",{url:"/tasklmdetail",cache:"false",templateUrl:"tpl/tasklmdetail.html",controller:"tasklmdetail"}).state("taskowndetail",{url:"/taskowndetail/:taskId",cache:"false",templateUrl:"tpl/taskowndetail.html",controller:"taskowndetail"}).state("tasklist",{url:"/tasklist",cache:"false",templateUrl:"tpl/tasklist.html",controller:"tasklist"}).state("student",{url:"/studentInfo/:sid",cache:"false",templateUrl:"tpl/student.html",controller:"student"}).state("mywallet",{url:"/mywallet",cache:"false",templateUrl:"tpl/mywallet.html",controller:"mywallet"}).state("help",{url:"/help",cache:"false",templateUrl:"tpl/help.html",controller:"help"}).state("taskincome",{url:"/taskincome/:typeId",cache:"false",templateUrl:"tpl/taskincome.html",controller:"taskincome"}).state("drawcash",{url:"/drawcash",cache:"false",templateUrl:"tpl/drawcash.html",controller:"drawcash"}).state("qiandao",{url:"/qiandao",cache:"false",templateUrl:"tpl/qiandao.html",controller:"qiandao"}).state("redenvelope",{url:"/redenvelope",cache:"false",templateUrl:"tpl/redenvelope.html",controller:"redenvelope"}).state("commonissue",{url:"/commonissue",cache:"false",templateUrl:"tpl/commonissue.html",controller:"commonissue"}).state("usercourse",{url:"/usercourse",cache:"false",templateUrl:"tpl/usercourse.html",controller:"usercourse"}).state("feedback",{url:"/feedback",cache:"false",templateUrl:"tpl/feedback.html",controller:"feedback"}).state("abountoz",{url:"/abountoz",cache:"false",templateUrl:"tpl/abountoz.html",controller:"abountoz"}).state("cashrecord",{url:"/cashrecord",cache:"false",templateUrl:"tpl/cashrecord.html",controller:"cashrecord"}).state("morelevel",{url:"/morelevel",cache:"false",templateUrl:"tpl/morelevel.html",controller:"morelevel"}),n.factory("myHttpInterceptor",["$rootScope","$q","$location","$injector","$timeout","$location",function(e,o,t,n,a){return{request:function(e){return e},requestError:function(e){return o.reject(e)},response:function(e){return(1===e.data.code||201===e.data.code)&&t.path("/start"),e},responseError:function(t){return e.ShowLoading=!0,e.loadText="网络请求错误!",a(function(){e.ShowLoading=!1},800),o.reject(t)}}}]),t.interceptors.push("myHttpInterceptor"),t.defaults.transformRequest=function(e){var o=[];for(var t in e)o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")},t.defaults.headers.post={"Content-Type":"application/x-www-form-urlencoded"}}]),angular.module("ozApp.Auth",[]).service("Auth",["$location","$rootScope","MyWebSock","Constant","httpService","tools","$timeout","$interval",function(e,o,t,n,a,i,s,r){function c(e){a.commonPost(n.getSessionid,{},function(o){e(o)})}function l(e,o,t){var i={uid:g.uid,token:e,sid:g.sid,uuid:g.uuid,sign:o};a.commonPost(n.userLogin,i,function(e){0==e.code?t(0,e):t(-1,-1===e.code?"请求失败":e.msg)})}function d(e,o,t){var i={deviceInfo:"nodeviceInfo",uuid:g.uuid,netType:1,longitude:12.3,latitude:1.2,promoCode:e,channelId:o||""};a.commonPost(n.regUser,i,function(e){t(e)})}function u(e){var o={cmd:"login",v:"v1.0",data:{sid:g.sid,timestamp:e}},n=angular.toJson(o);t.sendData(n)}function p(e,o){var n={cmd:"set_user_info",v:"v1.0",data:{sid:g.sid,uid:g.uid,token:e,sign:o}},a=angular.toJson(n);t.sendData(a)}function h(e,o){function n(e){0==e.data.code?o(!0,e.data.data.uuid):o(!1,"notgetdeviceinfo")}t.Reg("getInfo",n);var a={cmd:"getInfo",v:"v1.0",data:{sid:g.sid,uid:g.uid,bid:"b123456",type:e}},i=angular.toJson(a);t.sendData(i)}function f(e,o,n){d(e,o,function(e){function o(e){n(0==e.data.code?1:2)}0==e.code?(g.uid=e.data.uid,p(e.data.base.token,e.data.sign),t.Reg("set_user_info",o)):n(103==e.code?103:3)})}function m(e){c(function(o){function n(o){g.uuid=o.data.uuid,0==o.data.code?(g.uid=o.data.uid,l(o.data.token,o.data.sign,function(o,t){0===o?(v.userInfo.save(t.data),e(1)):e(2)})):e(3)}0==o.code?(g.sid=o.data.sid,t.Reg("login",n),u(o.data.timestamp)):e(4)})}var g={},v={userInfo:{save:function(e){i.getLocalStorage("baseInfo")&&(g=angular.fromJson(i.getLocalStorage("baseInfo"))),angular.extend(g,e),i.toLocalStorage("baseInfo",angular.toJson(g))},get:function(e){var o=angular.fromJson(i.getLocalStorage("baseInfo"));return o?o[e]:""}},login:m,reg:f,getInfoFromApp:h,getSessionId:c};return v}]),angular.module("ozApp.ConfigDrawcashAndDesc",[]).factory("ConstantDrawcashAndDesc",["$location",function(e){var o={1:1e3,2:5e3,3:1e4,4:5e4,5:1e5,6:1e7},t="当你推荐的徒弟完成下载任务时，你将获得最高20%的奖励，并且当你的徒弟再推荐加入的徒弟完成下载任务时，您也可以获得5%的收入，上不封顶哦！亲",n=["1、您必须是首次安装，非首次安装将不能获得奖励；","2、请仔细阅读任务要求，根据任务要求来完成任务；","3、大多数情况下，完成任务即可收到奖励，偶尔会由于第三方服务延迟不能及时返还，请耐心等待；","4、在使用本产品获取任务奖励的过程中遇到任何问题或疑问,可随时通过“个人中心->需要帮助->意见反馈”功能向我们进行问题反馈，我们会在核实之后尽快处理。"],a=["1、未检测到钥匙问题，请手动打开钥匙APP运行然后点击开始赚钱重新进入即可;","2、如果钥匙在运行，但还是提示未检测到钥匙，请手动关闭钥匙，然后再重启运行钥匙即可;","3、钥匙不能启动问题，请先长按删除钥匙，并进用safari浏览器输入我们官网www.ozhuan.com,点击安装助手,重新下载新版本钥匙APP，安装后在设置-->通用-->描述文件中信任钥匙APP，即可正常打开使用;","4、如还有其它问题，可以通过微信或者帮助中心-->反馈问题给我们,感谢你耐心看完。"],i=["loveU","sandx","1314Love","passNN","抚顺雷锋","alrfa","lookme","念佛、","走样","axib","方士的2"],s=["得到了3.00元","领取了5.00元红包","领取了一个任务","邀请了一位用户","提取了10元现金","提取了50元现金","邀请了2位用户","得到了2元任务奖励","得到了3元任务奖励","邀请了2位好友","提取了30元现金"];return{WithrawCashGear:o,studentDescStr:t,noRecieveLmPrizeExplain:n,commonIssueDescArray:a,startPageDisplayNameArray:i,startPageDisplayTextArray:s}}]),angular.module("ozApp.ConfigPlayerLvRedBag",[]).factory("ConstantPlayerLvRedBag",["$location",function(e){var o=[{Level:0,IncomeNeed:0,StudentAmountNeed:0,TeachRewardRote:10,Title:"勤学苦练"},{Level:1,IncomeNeed:1e3,StudentAmountNeed:1,TeachRewardRote:11,Title:"初出茅庐"},{Level:2,IncomeNeed:3e3,StudentAmountNeed:3,TeachRewardRote:12,Title:"小试牛刀"},{Level:3,IncomeNeed:8e3,StudentAmountNeed:5,TeachRewardRote:13,Title:"崭露头角"},{Level:4,IncomeNeed:15e3,StudentAmountNeed:10,TeachRewardRote:14,Title:"精益求精"},{Level:5,IncomeNeed:3e4,StudentAmountNeed:20,TeachRewardRote:15,Title:"一方威名"},{Level:6,IncomeNeed:5e4,StudentAmountNeed:50,TeachRewardRote:16,Title:"炉火纯青"},{Level:7,IncomeNeed:1e5,StudentAmountNeed:100,TeachRewardRote:17,Title:"笑傲江湖"},{Level:8,IncomeNeed:2e5,StudentAmountNeed:150,TeachRewardRote:18,Title:"纵横天下"},{Level:9,IncomeNeed:5e5,StudentAmountNeed:200,TeachRewardRote:19,Title:"一代宗师"},{Level:10,IncomeNeed:1e6,StudentAmountNeed:300,TeachRewardRote:20,Title:"独孤求败"}],t=[{Gear:0,CashAmount:2},{Gear:1,CashAmount:5},{Gear:2,CashAmount:10},{Gear:3,CashAmount:100},{Gear:4,CashAmount:200},{Gear:5,CashAmount:500},{Gear:6,CashAmount:1e3},{Gear:7,CashAmount:1e4}];return{PlayerLvCfg:o,GrabCashGear:t}}]),angular.module("ozApp.Config",[]).factory("Constant",["$location",function(e){var o="1.0.8.5",t="/player/get_data?action=userObj",n="http://cdn.ozhuan.com/ozhuan/",a="itms-services://?action=download-manifest&url=https://ozhuan.oss-cn-shanghai.aliyuncs.com/EarnKeyEnterprise2016_06_03_17_17.plist",i="/player/get_data?action=taskListArray",s="/player/get_data?action=taskInfo",r="/player/get_data?action=studentInfo",c="/player/apprentice",l="/player/get_data?action=exInfo",d="/player/commit_ex_info",u="/player/make_session_id",p="/player/reg",h="/player/login",f="player/getRewardHistory",m="/player/accept_task",g="/player/commit_task",v="https://itunes.apple.com/WebObjects/MZStore.woa/wa/search?media=software&country=CN&mt=8&term=",w="https://itunes.apple.com/WebObjects/MZStore.woa/wa/search?mt=8&submit=edit&term=",k="ws://localhost:9235/service",T="http://"+e.host()+":"+e.port()+"/player/commit_task",y="ozhuan://",S=!0,b="weixin://",I="/player/withraw_cash",x="/player/every_day_sign_in",A="/player/grab_cash",C="/player/get_data?action=noviceTaskListAndInfos",D="/player/get_withraw_cash_record",L="/player/feedback",$="http://m.ozhuan.com/tpl/wx_share.html",N="ozhuan://share?",z="/player/get_data?action=signRecord",B="/player/event_notify",R="/player/bind_phone",O="/player/commit_phone_check_num",P="http://wx.ozhuan.com/download_ozapp",_=120,j=.2,U="http://myyg.ozhuan.com";return{Version:o,appIcon:n,getUserInfo:t,getTaskList:i,getTaskDetail:s,getStuInfo:r,userExInfo:l,commitExInfo:d,baishi:c,getSessionid:u,regUser:p,userLogin:h,rewardHistory:f,acceptTask:m,commitTask:g,webSockUrl:k,webSockRe:S,toAppstoreSearch:v,toAppstoreKeyWork:w,commitUrl:T,safariToWx:b,drawCash:I,qianDao:x,redEnvelope:A,newUserTaskList:C,cashRecord:D,feedback:L,ozScheme:y,wxshare:N,shareurl:$,qiandaoData:z,shareCommit:B,sendCode:R,wxToSafari:P,commitCode:O,plistAdd:a,runTargetAppTime:_,runAppTimeOut:j,GoToYyg:U}}]),angular.module("ozApp.controllers",[]).controller("startController",["$rootScope","$scope","Auth","$location","$interval","tools","MyWebSock","Constant","ConstantDrawcashAndDesc","$timeout","httpService","Task",function(e,o,t,n,a,i,s,r,c,l,d,u){function p(){t.login(function(e){switch(e){case 1:o.websockinfo="登录成功...",n.url("/userindex");break;case 2:o.websockinfo="登录失败,请刷新或者删除钥匙重新安装";break;case 3:o.$apply(function(){h()});break;case 4:o.websockinfo="登录服务器失败,请刷新重试"}})}function h(){o.websockinfo="正在注册...";var e=i.getCookie("channelId");if(null!=e)return void f(e);o.InviteCodeBoxShow=!0;var t=i.getCookie("promocode");null!=t&&(o.teachObj.teachedId=parseInt(t))}function f(e){t.reg("",e,function(e){o.InviteCodeBoxShow=!1,1===e?(o.websockinfo="注册成功...",i.clearCookie("channelId"),i.clearCookie("promocode"),i.clearCookie("nickname"),p()):2===e?o.websockinfo="注册失败...":3===e&&(o.websockinfo="向服务器注册失败,请反馈给我们")})}o.websockinfo="正在连接...",o.version="v"+r.Version,o.InviteCodeBoxShow=!1,o.showIos9Seting=!1,o.isWx=!1,(i.isQQ()||i.isWeixin())&&(o.isWx=!0),o.isWuhen=i.isWuHen();var m=a(function(){s.webSockStatus()?u.getAppVersion(function(e){if(a.cancel(m),0==e.data.code){var t=e.data.buildVersion;if(r.Version>t)return void o.$apply(function(){o.websockinfo="偶赚有更新,请点击安装助手更新APP",window.location.href=r.plistAdd});o.$apply(function(){o.websockinfo="正在登录..."}),p()}else o.websockinfo="连接助手失败，请重试"}):o.websockinfo="安装偶赚助手,每天收入几十元零花钱,可提现！"},2e3);o.teachObj={teachedId:""},o.getTeachedId=function(){var e=o.teachObj.teachedId;return""==e||null==e?void(o.teachIdTips="邀请码错误"):void t.reg(e,"",function(e){1===e?(o.websockinfo="注册成功...",o.InviteCodeBoxShow=!1,i.clearCookie("promocode"),i.clearCookie("nickname"),p()):2===e?(o.InviteCodeBoxShow=!1,o.websockinfo="注册失败..."):3===e?(o.InviteCodeBoxShow=!1,o.websockinfo="向服务器注册失败,请反馈给我们"):103===e&&(o.teachIdTips="邀请码错误")})},o.goIndex=function(){f("")};var g;o.isInstall=!0,o.installOz=function(){if(o.isWx)return void(window.location.href=r.wxToSafari);if(o.isInstall=!0,o.installText="请稍候",i.iOSVersion()>=9){o.showIos9Seting=!0;var e=10;g&&a.cancel(g),g=a(function(){o.installText="请稍候("+e+")",e--,0>e&&(a.cancel(g),o.installText="去设置",o.isInstall=!1)},1e3)}window.location.href=r.plistAdd},i.removeStorage(),o.openApp=function(){return o.isWx?void(window.location.href=r.wxToSafari):void(window.location.href=r.ozScheme)},o.ios9ToSeting=function(){o.isInstall||(location.href="prefs:root=General&path=ManagedConfigurationList")},o.listArray=[];for(var v=c.startPageDisplayNameArray,w=c.startPageDisplayTextArray,k=0;12>k;k++){var T=i.getRandNum(11);o.listArray.push({title:v[T],time:"1分钟前",icon:"http://cdn.ozhuan.com/ozhuan/img/user-icon/user_"+(T+1)+".jpg",desc:w[T]})}o.$on("$destroy",function(){m&&a.cancel(m),g&&a.cancel(g)})}]).controller("ozIndexController",["$rootScope","$scope","httpService","$location","Constant","Auth","Task","$interval","tools","$timeout","MyWebSock",function(e,o,t,n,a,i,s,r,c,l,d){function u(){c.onMsg("sendMsgTimeout",function(e){o.ShowZhuanLoad=!1,o.tasklistLoadText="加载第三方列表任务失败,请重试"},o),s.getTask3rdList(p)}function p(e){o.taskListLoaded=!1,0==e.data.code?o.$apply(function(){o.taskList3rd=e.data.data,c.toLocalStorage("doujinTask",angular.toJson(e.data.data))}):(c.showTips(1e3,"加载第三方列表任务失败"),o.tasklistLoadText="加载第三方列表任务失败...")}function h(){c.showTips(2e3,"您已有一个任务正在进行~");var e=r(function(){document.body.scrollTop<50?r.cancel(e):window.scrollBy(0,-30)},2)}o.goYyg=function(){window.location.href=a.GoToYyg},o.drawCash=function(){n.url("/mywallet")},o.userCenter=function(){n.url("/usercenter")},o.AppIcon=a.appIcon,o.userObj={base:{icon:"/img/deault_3.jpg",userNickname:"未知用户"},economics:{allBalance:0,allIncome:0,todayIncome:0}},o.todayIncome=0,i.userInfo.get("base").userNickname&&(o.userObj.base.icon=i.userInfo.get("base").icon,o.userObj.base.userNickname=i.userInfo.get("base").userNickname||"不明用户",o.userObj.economics.allBalance=i.userInfo.get("economics").allBalance||0,o.userObj.economics.allIncome=i.userInfo.get("economics").allIncome||0),c.getLocalStorage("todayIncome")&&(o.todayIncome=parseInt(c.getLocalStorage("todayIncome"))),o.addrmbShow=!1,o.drawcash=function(){n.url("/drawcash")},o.taskListLoaded=!0,o.taskListLoadedown=!0,o.tasklistLoadText="正在加载任务列表...",l(function(){t.commonGet(a.getUserInfo+"&timeStamp="+Date.parse(new Date)/1e3,function(e){if(0==e.code){o.userObj=e.data;var t=c.getLocalStorage("todayIncome"),a=o.userObj.economics.todayIncome;t?o.todayIncome=parseInt(t):o.todayIncome=a,a>parseInt(t)&&(o.addrmbShow=!0,o.addrmb=a-parseInt(t),l(function(){o.todayIncome=a,o.addrmbShow=!1},2e3)),i.userInfo.save(e.data),c.toLocalStorage("todayIncome",a)}else c.showTips(1e3,"获取用户信息失败"),n.url("/start")})},100),o.playerTaskInfo={},o.normalTaskInfo=[],o.acceptTaskInfo=[],o.completeTaskInfo=[],o.taskList3rd=[],c.getLocalStorage("doujinTask")?(o.taskListLoaded=!1,o.taskList3rd=angular.fromJson(c.getLocalStorage("doujinTask")),u()):u(),o.click3rd=function(e,o,t,a,i,s,r){var l={id:e,name:o,icon:t,steptext1:a,points:i,size:s,steptext2:r};c.toLocalStorage("doujintaskdetail",angular.toJson(l)),n.url("/tasklmdetail")},t.commonGet(a.getTaskList+"&timeStamp="+Date.parse(new Date)/1e3,function(e){0==e.code&&(e.data.playerTaskInfo&&angular.forEach(e.data.playerTaskInfo,function(e){o.playerTaskInfo[e.TaskId]=e.CurState}),angular.forEach(e.data.taskListBuffs,function(e){return 1===o.playerTaskInfo[e.Id]?(o.acceptTaskInfo.push(e),e.status=1,void c.toLocalStorage("platformTask"+e.Id,angular.toJson(e))):2===o.playerTaskInfo[e.Id]?void o.completeTaskInfo.push(e):(o.normalTaskInfo.push(e),e.status=0,void c.toLocalStorage("platformTask"+e.Id,angular.toJson(e)))}),o.taskListLoadedown=!1,o.tasklistLoadText="正在加载第三方任务列表...")}),o.ozXsrw=function(){n.url("/tasklist")},o.ozQd=function(){n.url("/qiandao")},o.ozQhb=function(){n.url("/redenvelope")},o.ozStrw=function(){n.url("/studentInfo/1")},o.clickNormal=function(e){o.ShowZhuanLoad=!0;var t=c.getLocalStorage("platformTask"+e);if(!t)return o.ShowZhuanLoad=!1,void c.showTips(1e3,"抢任务失败，请重试");var r=angular.fromJson(t),l={taskId:r.Id,prj_name:r.prj_name,bundle_id:r.bundle_id,appid:r.appid,CheckInstalledUrl:r.CheckInstalledUrl,timeout:parseInt(r.DeadlineTimeLong)||300,runTargetAppTime:a.runTargetAppTime};c.onMsg("sendMsgTimeout",function(e){o.ShowZhuanLoad=!1,c.showTips(2e3,"连接钥匙超时,请重启钥匙试试")},o),c.onMsg("ozAppIsNoReady",function(e){o.ShowZhuanLoad=!1},o),i.getSessionId(function(t){if(0==t.code){var a={sid:t.data.sid};i.userInfo.save(a),s.startTask(l,function(t,a){o.$apply(function(){o.ShowZhuanLoad=!1}),0===t?(c.showTips(1e3,"成功抢到任务"),n.url("/taskowndetail/"+e)):1===t?h():102===t?c.showTips(2e3,"您已安装过此应用"):c.showTips(1e3,"抢任务失败,ErrCode="+t)})}else c.showTips(2e3,"获取sid出错了~")})},o.clickAccept=function(e){n.url("/taskowndetail/"+e)},o.$on("$destroy",function(){window.onscroll=null})}]).controller("tasklmdetail",["$rootScope","$scope","$stateParams","$location","httpService","Constant","ConstantDrawcashAndDesc","Task","tools","$interval",function(e,o,t,n,a,i,s,r,c,l){function d(e){0==e.data.code?(o.$apply(function(){c.showTips(1e3,"放弃任务成功")}),n.url("/userindex")):o.$apply(function(){c.showTips(1e3,"放弃任务失败，未找到此任务")})}o.ozBackIndex=function(){window.history.go(-1)},o.title="联盟任务",o.showLm=!1,o.noRecieveLmPrizeExplain=s.noRecieveLmPrizeExplain,o.abountLm=function(){o.showLm=!0},o.closeLm=function(e,t){t.stopPropagation(),2!=e&&(o.showLm=!1)},o.detailObj={},o.toAppStore=function(e){location.href=i.toAppstoreSearch},window.onCopy=function(){location.href=i.toAppstoreSearch};var u=c.getLocalStorage("doujintaskdetail");o.detailObj=angular.fromJson(u),o.commitTaskText="提交任务",o.active=!0,o.disabled=!1,o.beginTask=function(e){function t(e){o.ShowZhuanLoad=!1,0==e.data.code?o.$apply(function(){c.showTips(1e3,"接受任务成功")}):o.$apply(function(){c.showTips(1e3,"暂不能接受此任务")})}o.ShowZhuanLoad=!0,r.start3rdTask(e,t)},o.giveUpTask=function(e){r.giveUp3rdTask(e,d)}}]).controller("taskowndetail",["$rootScope","$scope","$stateParams","$location","httpService","Constant","ConstantDrawcashAndDesc","Task","tools","$interval",function(e,o,t,n,a,i,s,r,c,l){var d=t.taskId;if(!d)return void c.showTips(1e3,"糟糕,获取任务Id出错了");o.ozBackIndex=function(){return 5==h||2==h?void(o.showGiveupBox=!0):void window.history.go(-1)},o.AppIcon=i.appIcon,o.title="平台任务详情",o.detailObj={};var u=c.getLocalStorage("platformTask"+d);if(!u)return void c.showTips(1e3,"糟糕,获取任务详情出错了");var p=angular.fromJson(u);o.detailObj=p,o.toAppStore=function(e){location.href=i.toAppstoreKeyWork+e+"#software",console.log(i.toAppstoreKeyWork+e+"#software")},o.showGiveupBox=!1,o.giveUpTask=function(e){o.showGiveupBox=!0},o.giveUpTaskTrue=function(e){r.giveUpOwnTask(e,function(e){0==e.data.code?(o.$apply(function(){o.showGiveupBox=!1,c.showTips(1e3,"放弃任务成功")}),window.history.go(-1)):o.$apply(function(){o.showGiveupBox=!1,c.showTips(1e3,e.data.msg||"放弃任务失败")})})},o.giveUpTaskFalse=function(){o.showGiveupBox=!1},o.taskState="正在获取";var h=0;o.isComplete=!1;var f=l(function(){r.getTaskState(d,function(e){h=e.data.code,0==e.data.code?o.$apply(function(){o.isComplete=!0,o.taskState=e.data.msg}):o.$apply(function(){o.taskState=e.data.msg||"获取状态出错"})})},3e3),m=parseInt(o.detailObj.DeadlineTimeLong/60);(isNaN(m)||5>m)&&(m=5),o.timeout=m,o.showSWBox=!1,o.shiwanBox=function(){o.showSWBox?(document.getElementById("shiwanicon").style.webkitTransform="rotate(-90deg)",o.showSWBox=!1):(o.showSWBox=!0,document.getElementById("shiwanicon").style.webkitTransform="rotate(90deg)")},o.shiwanInfo=["1,请在规定时间内按操作进行下载，下载完成后打开进行试玩;","2,超过规定时间未试玩,则此次任务无效;","3,试玩过程中请勿关闭钥匙APP,若关闭则此次任务无效;","如果您对我们有任何意见或建议,请至帮助中心的意见反馈提交反馈给我们,我们会及时查看并解决问题。"],o.$on("$destroy",function(){f&&l.cancel(f)})}]).controller("tasklist",["$scope","$stateParams","$location","httpService","Constant","tools","$timeout",function(e,o,t,n,a,i,s){function r(){0==e.compeleteTask.length&&(e.compeleteTask=[{Title:"无",Reward:0}]),0==e.everyDayTask.length&&(e.everyDayTask=[{Title:"无",Reward:0}]),0==e.normalTask.length&&(e.normalTask=[{Title:"无",Reward:0}])}o.listId;e.ozBackIndex=function(){window.history.go(-1)},e.title="新手任务详情",e.listObj={desc:!1,listdata:[],descShow:!1,listShow:!1},e.listObj.listShow=!0,e.listObj.title="新手任务列表",e.compeleteTask=[],e.everyDayTask=[],e.normalTask=[],n.commonGet(a.newUserTaskList,function(o){if(0==o.code&&""!=o.data.noviceTaskList){var t=(o.data,o.data.playerNoviceTaskInfo.complates),n={};""!=t&&angular.forEach(t,function(e,o){n[e]=!0});var a=o.data.noviceTaskList;angular.forEach(a,function(o,t){n[o.ID]&&e.compeleteTask.push({Title:o.Title,Reward:o.Reward}),!n[o.ID]&&o.IsEveryDay&&e.everyDayTask.push({Title:o.Title,Reward:o.Reward,EventType:o.EventType}),n[o.ID]||o.IsEveryDay||e.normalTask.push({Title:o.Title,Reward:o.Reward,EventType:o.EventType})})}r()}),e.goJob=function(o){switch(o){case 1:t.url("/userindex");break;case 5:case 2:case 3:case 4:t.url("/studentInfo/2");break;case 6:e.showWxBind=!0;break;case 8:t.url("/usercenter");break;case 7:i.showTips(3e3,"使用微信搜索并关注偶赚公众号"),s(function(){location.href=a.safariToWx},3500)}}}]).controller("student",["$scope","$stateParams","$location","httpService","Constant","ConstantPlayerLvRedBag","ConstantDrawcashAndDesc","tools","Auth","$timeout","Task",function(e,o,t,n,a,i,s,r,c,l,d){function u(e){var o="";1==e?o="share2WeiXinFriend":2==e&&(o="share2WeiXinCircleOfFriend");var t={eventType:o};n.commonPost(a.shareCommit,t,function(e){})}e.ozBackIndex=function(){window.history.go(-1)},e.title="收徒任务",e.desc=s.studentDescStr,e.stObj={StudentAmount:0,StudentsReward:0,TodayAmount:0,TodayAllReward:0,Level:"LV1"};var p=i.PlayerLvCfg,h=[];for(var f in p)h.push(p[f].Title);e.moreLevel=function(){t.url("/morelevel")},e.nickName="勤学苦练",e.nextNickName="初出茅庐",e.nickNameArray=h,n.commonGet(a.getStuInfo+"&timeStamp="+Date.parse(new Date)/1e3,function(o){0==o.code?(e.stObj=o.data,e.nickName=e.nickNameArray[e.stObj.Level],e.stObj.Level<10?e.nextNickName=e.nickNameArray[e.stObj.Level+1]:e.nextNickName="已达顶级"):e.stObj=[]}),e.promoCode=0;var m=c.userInfo.get("base").promoCode;m?e.promoCode=m:e.promoCode="无法获取",e.stShow=!1,2==o.sid&&(e.stShow=!0),e.shareClose=function(o,t){t.stopPropagation(),2!=o&&(e.stShow=!1)},e.shareToWx=function(o){if(""==c.userInfo.get("exinfo").WeiXinOpenId)return r.showTips(2e3,"请绑定微信后再收徒噢"),void l(function(){e.showWxBind=!0},2e3);u(o);var t=c.userInfo.get("base").userNickname,n=c.userInfo.get("base").icon,i=a.shareurl+"?promocode="+m+"&nickname="+t+"&imgurl="+n;i=encodeURIComponent(i);var s="偶赚-好友邀请",p="好友给您发红包啦,每月轻轻松松赚几百零花钱,你也快来试试吧!",h="&text="+i+"&title="+s+"&desc="+p;navigator.userAgent.match(/Safari/i)?1==o?window.location.href=a.wxshare+"action=shareUrlToHY"+h:2==o&&(window.location.href=a.wxshare+"action=shareUrlToPYQ"+h):d.shareToWx(o,i,s,p)},e.ozStSubmit=function(){e.stShow=!0}}]).controller("usercenter",["$interval","$scope","$stateParams","$location","httpService","Constant","tools","Auth",function(e,o,t,n,a,i,s,r){o.ozBackIndex=function(){window.history.go(-1)},o.title="个人中心",o.help=function(){n.url("/help")},o.userinfo={NickName:"",Gender:"男",Job:"上班族",Birthday:"2016-01-01",Phone:"未绑定",icon:"",WeChat:"未绑定"},o.showBindWxBtn=!0,o.showBindPhoneBtn=!0,o.showBindWxPage=!1,o.showBindPhonePage=!1,o.seeDetail=function(){n.url("/mywallet")},o.allBalance=r.userInfo.get("economics").allBalance,o.userinfo.NickName=r.userInfo.get("base").userNickname,o.userinfo.icon=r.userInfo.get("base").icon,""!=r.userInfo.get("exinfo").WeiXinOpenId&&(o.userinfo.WeChat="已绑定",o.showBindWxBtn=!1),""!=r.userInfo.get("exinfo").Phone&&(o.userinfo.Phone=r.userInfo.get("exinfo").Phone,o.showBindPhoneBtn=!1),o.changeinfo=function(){n.url("/userinfochange")},o.bindWx=function(){""==r.userInfo.get("exinfo").WeiXinOpenId&&(o.showWxBind||(o.showWxBind=!0))},o.sendText="发送验证码",o.phoneObj={};var c;o.sendCode=function(){if(11!=(o.phoneObj.phoneNum+"").length)return void s.showTips(1e3,"手机号需11位");if(!angular.isNumber(o.phoneObj.phoneNum))return void s.showTips(1e3,"手机号必须为数字");o.disableSend=!0;var t=60;o.sendText=t+"秒",c=e(function(){t--,o.sendText=t+"秒",0>=t&&(e.cancel(c),o.disableSend=!1,o.sendText="发送验证码")},1e3);var n={pn:o.phoneObj.phoneNum};a.commonPost(i.sendCode,n,function(t){0==t.code?s.showTips(1e3,"验证码发送成功"):(e.cancel(c),o.disableSend=!1,o.sendText="发送验证码",s.showTips(1e3,"验证码发送失败"))})},o.bindPhone=function(){""==r.userInfo.get("exinfo").Phone&&(o.showPhoneBind=!0)},o.commitPhone=function(){if(5!=(o.phoneObj.codeNum+"").length)return void s.showTips(1e3,"验证码需5位");if(11!=(o.phoneObj.phoneNum+"").length)return void s.showTips(1e3,"手机号需11位");if(!angular.isNumber(o.phoneObj.phoneNum))return void s.showTips(1e3,"手机号必须为数字");if(!angular.isNumber(o.phoneObj.codeNum))return void s.showTips(1e3,"验证码是数字");var e={cn:o.phoneObj.codeNum};a.commonPost(i.commitCode,e,function(e){0==e.code?(s.showTips(2e3,"绑定手机成功"),n.url("/userindex")):104==e.code?s.showTips(2e3,"验证码过期"):105==e.code&&s.showTips(2e3,"验证码错误")})},o.$on("$destroy",function(){c&&e.cancel(c)})}]).controller("userinfochange",["$scope","$location","httpService","Constant","tools","$timeout","Auth",function(e,o,t,n,a,i,s){e.ozBackIndex=function(){window.history.go(-1)},e.title="修改资料",e.Birthday=new Date("2016-01-01"),e.userinfo={NickName:"",Gender:"男",Job:"上班族"},e.userinfo.NickName=s.userInfo.get("base").userNickname;var r=s.userInfo.get("exinfo").Birthday.replace(/-/g,"/");e.Birthday=new Date(r),e.userinfo.Gender=s.userInfo.get("exinfo").Gender,e.userinfo.Job=s.userInfo.get("exinfo").Job,e.commit=function(){if(!angular.isDefined(e.userinfo.NickName))return void a.showTips(1e3,"请填写昵称.");var r=e.userinfo,c=e.Birthday.getFullYear(),l=e.Birthday.getMonth()+1,d=e.Birthday.getDate(),u=c+"-"+l+"-"+d;r.Birthday=u,t.commonPost(n.commitExInfo,r,function(e){0==e.code?(t.commonGet(n.getUserInfo+"&timeStamp="+Date.parse(new Date)/1e3,function(e){0==e.code&&s.userInfo.save(e.data)}),a.showTips(1e3,"修改成功,正跳转到个人中心.."),i(function(){o.url("/usercenter")},1500)):a.showTips(1e3,"修改资料失败，请稍后修改")})}}]).controller("mywallet",["$scope","$location","httpService","Constant","tools","$timeout","Auth",function(e,o,t,n,a,i,s){e.ozBackIndex=function(){window.history.go(-1)};var r=s.userInfo.get("economics").allBalance||0,c=s.userInfo.get("economics").allIncome||0,l=c-r;0>l&&(l=0),e.title="我的钱包",e.mywallet={canDrawCash:r,DrawCashed:l,allIncome:c},e.cashhistory=function(){o.url("/cashrecord")},e.drawcash=function(){o.url("/drawcash")},e.taskincome=function(){o.url("/taskincome/1")},e.friendincome=function(){o.url("/taskincome/2")},e.otherincome=function(){o.url("/taskincome/3")}}]).controller("taskincome",["$scope","$location","httpService","Constant","tools","$timeout","$stateParams",function(e,o,t,n,a,i,s){e.ozBackIndex=function(){window.history.go(-1)},e.title="详细列表",e.descShow=!0,e.descText="暂无数据",e.desctext="任务,赚了";var r=parseInt(s.typeId),c="task";switch(r){case 1:c="task";break;case 2:c="friend",e.title="好友提成";break;case 3:c="others",e.title="其它收入",e.desctext=",赚了";break;default:c="task"}t.commonGet(n.rewardHistory+"?rewardType="+c+"&timeStamp="+Date.parse(new Date)/1e3,function(o){0==o.code&&""!=o.data?(e.listInfo=o.data,e.descShow=!1):a.showTips(1e3,"暂无数据,赶紧做任务赚钱吧~")})}]).controller("help",["$scope","$location","httpService","Constant","tools","$timeout",function(e,o,t,n,a,i){e.ozBackIndex=function(){window.history.go(-1)},e.title="帮助中心",e.helpobj={content:"这里是帮助中心,为您提供全面帮助服务"},e.commonIssue=function(){o.url("/commonissue")},e.userCourse=function(){o.url("/usercourse")},e.abountMe=function(){o.url("/abountoz")},e.feedback=function(){o.url("/feedback")}}]).controller("drawcash",["$scope","$location","Auth","tools","Constant","ConstantDrawcashAndDesc","httpService",function(e,o,t,n,a,i,s){function r(e,o,t){var n={amountGear:e,channel:"WeiXin",realName:o};s.commonPost(a.drawCash,n,function(e){t(0==e.code?!0:!1)})}e.ozBackIndex=function(){window.history.go(-1)};var c=t.userInfo.get("economics").allBalance;(angular.isUndefined(c)||""==c)&&(c=0);var l="",d="",u=!0;l=t.userInfo.get("exinfo").WeiXinOpenId,d=t.userInfo.get("base").userNickname,""==l?(l="未绑定,点我绑定",u=!1):(l=d,u=!0),e.title="微信提现",e.drawcash={yue:c,wxid:l},e.bindWx=function(){u||(e.showWxBind=!0)},e.drawcashName="";var p=[],h=i.WithrawCashGear;for(var f in h)p.push(h[f]/100);e.drawcashNumArray=p,e.drashSelected=0,e.drawcashNum=function(o){e.drashSelected=o},e.commit=function(){if(""==e.drawcashName)return void n.showTips(1e3,"请输入真实姓名");if(!u)return void n.showTips(1e3,"请绑定微信帐号后再提现");if(e.drawcashNumArray[e.drashSelected]>e.drawcash.yue/100)return void n.showTips(1e3,"余额不足以提现,请努力赚钱吧");var o="是否提取"+e.drawcashNumArray[e.drashSelected]+"元到微信帐号?",i=confirm(o);i&&r(e.drashSelected+1,e.drawcashName,function(e){e?(s.commonGet(a.getUserInfo+"&timeStamp="+Date.parse(new Date)/1e3,function(e){0==e.code&&t.userInfo.save(e.data)}),alert("提现申请成功,3个工作日内审核无问题后发到您的微信账户上")):n.showTips(1e3,"提现申请失败，请稍候再试")})},e.showWxBind=!1}]).controller("qiandao",["$scope","$location","httpService","Constant","tools","Auth",function(e,o,t,n,a,i){function s(){var o=angular.fromJson(a.getLocalStorage("qd")),t=o.CurMonSignedRecord;angular.forEach(t,function(o,t){h>=t+1&&e.jsonData.push({val:t+1,isSign:o})})}function r(o){t.commonGet(n.qiandaoData+"&timeStamp="+Date.parse(new Date)/1e3,function(t){if(0==t.code&&(a.toLocalStorage("qd",angular.toJson(t.data)),2==o)){e.jsonData=[];for(var n=0;f>n;n++)e.jsonData.push({val:"",isSign:!1});angular.forEach(t.data.CurMonSignedRecord,function(o,t){h>=t+1&&e.jsonData.push({val:t+1,isSign:o})})}})}function c(e,o){var t=new Date(e,o,0);return t.getDate()}function l(e,o){var t=new Date(e,o,0);return t.setDate(1),t.getDay()}e.ozBackIndex=function(){window.history.go(-1)},e.title="签到任务",e.btnContent="签到",e.jsonData=[];var d=new Date,u=d.getFullYear(),p=d.getMonth()+1,h=c(u,p);e.yearMonth=u+"年"+p+"月";for(var f=l(u,p),m=0;f>m;m++)e.jsonData.push({val:"",isSign:!1});e.lastMonth=!0,e.lastMonthFun=function(){e.lastMonth=!1;var o,t;1==p?(t=12,o=u-1):(t=p-1,o=u),e.yearMonth=o+"年"+t+"月";var n=l(o,t);e.jsonData=[];for(var i=0;n>i;i++)e.jsonData.push({val:"",isSign:!1});var s=c(o,t);if(a.getLocalStorage("qd")){var r=angular.fromJson(a.getLocalStorage("qd")),d=r.LastMonSignedRecord;angular.forEach(d,function(o,t){s>=t+1&&e.jsonData.push({val:t+1,isSign:o})})}},e.nextMonth=function(){e.yearMonth=u+"年"+p+"月",e.lastMonth=!0,e.jsonData=[];for(var o=0;f>o;o++)e.jsonData.push({val:"",isSign:!1});s()},a.getLocalStorage("qd")?(s(),r(1)):r(2),e.isQianDao=!0;var g=i.userInfo.get("EveryDayInfos").SignedOffCount;0==g?e.isQianDao=!1:(e.btnContent="今日已签到",e.isQianDao=!0),e.qiandao=function(){t.commonPost(n.qianDao,"{}",function(o){0==o.code&&o.data.signInResult?(r(2),a.showTips(2e3,"签到成功,获得1次抽奖次数"),e.btnContent="今日已签到",e.isQianDao=!0):a.showTips(1e3,"签到失败，请稍后再试")})},e.goYyg=function(){window.location.href=n.GoToYyg}}]).controller("redenvelope",["$scope","$location","httpService","Constant","ConstantPlayerLvRedBag","tools","Auth","$timeout","$interval",function(e,o,t,n,a,i,s,r,c){function l(e){d(50,e)}function d(o,t){var n=t,a=0;b=c(function(){a++,a>7&&(a=0,o=1.8*o,c.cancel(b),d(o,n)),e.selected=a,o>=500&&a==n&&(c.cancel(b),S=!1,r(function(){g[n]&&(c.cancel(b),e.showJoy=!0,e.gearsNum=v[n],e.gearsUnit=w[n])},200))},o)}function u(o){t.commonGet(n.redEnvelope+"?timeStamp="+Date.parse(new Date)/1e3,function(a){0==a.code?(e.envelopeNum=a.data.CanGrabCashCount||0,t.commonGet(n.getUserInfo+"&timeStamp="+Date.parse(new Date)/1e3,function(e){0==e.code&&s.userInfo.save(e.data)}),o(a.data.amountGear)):i.showTips(1e3,"抽奖失败,请稍后再试")})}function p(){if(x)I.scrollTop=0,x=!1;else{I.scrollTop+=1;var e=I.scrollTop;e==A&&(x=!0)}}e.ozBackIndex=function(){window.history.go(-1)},e.title="抢红包",e.envelopeNum=0;var h=s.userInfo.get("EveryDayInfos").CanGrabCashCount;""!=h&&!angular.isUndefined(h)&&h>=0&&(e.envelopeNum=h);var f,m,g=[],v=[],w=[],k=a.GrabCashGear;for(var T in k){var y=k[T].CashAmount;y>=100?(f=y/100,m="元"):100>y&&y>=10?(f=y/10,m="角"):(f=y,m="分"),v.push(f),w.push(m),g.push(f+m)}var S=!1;e.moneyNum=v,e.moneyUnit=w,e.selected=0,e.beginDraw=function(){S||(S=!0,e.envelopeNum>0?u(l):(S=!1,i.showTips(2e3,"剩余次数不足,签到和做任务都可获得抽红包机会")))};var b;e.closeJoy=function(){e.showJoy=!1};var I=document.getElementById("roll-board"),x=!1,A=I.offsetHeight,C=c(function(){p()},50);e.$on("$destroy",function(){c.cancel(C)})}]).controller("commonissue",["$scope","$location","ConstantDrawcashAndDesc",function(e,o,t){e.ozBackIndex=function(){window.history.go(-1)},e.title="常见问题",e.textArray=t.commonIssueDescArray}]).controller("usercourse",["$scope","$location",function(e,o){
e.ozBackIndex=function(){window.history.go(-1)},e.title="新手教程",e.textArray=""}]).controller("feedback",["$scope","$location","tools","$timeout","httpService","Constant",function(e,o,t,n,a,i){e.ozBackIndex=function(){window.history.go(-1)},e.title="意见反馈",e.commit=function(){if(angular.isUndefined(e.feedbackText))t.showTips(1e3,"亲，您还未输入任何内容");else{if(e.feedbackText.length<10)return void t.showTips(1e3,"连十个字凑不齐么");var s={content:e.feedbackText};a.commonPost(i.feedback,s,function(e){0==e.code?(t.showTips(1e3,"提交成功，感谢您的建议。"),n(function(){o.url("/help")},2e3)):t.showTips(1e3,e.msg||"出问题啦，请下次在尝试,谢谢")})}}}]).controller("abountoz",["$scope","$location","Constant",function(e,o,t){e.ozBackIndex=function(){window.history.go(-1)},e.title="关于我们",e.version=t.Version}]).controller("cashrecord",["$scope","$location","httpService","Constant",function(e,o,t,n){e.ozBackIndex=function(){window.history.go(-1)},e.title="提现记录",e.descShow=!0,e.descText="暂无数据",e.recordArray=[],t.commonGet(n.cashRecord+"?timeStamp="+Date.parse(new Date)/1e3,function(o){0==o.code&&""!=o.data?(e.descShow=!1,e.recordArray=o.data,angular.forEach(e.recordArray,function(e,o){0==e.State?e.status="正审核":1==e.State?e.status="提现成功":e.status="申请失败"})):e.descShow=!0})}]).controller("morelevel",["$scope","$location","ConstantPlayerLvRedBag",function(e,o,t){e.ozBackIndex=function(){window.history.go(-1)},e.title="等级描述",e.moreLevelDetail=t.PlayerLvCfg}]),angular.module("ozApp.directive",[]).directive("traceless",function(){return{restrict:"E",template:'		<div class="start-wuhen" ng-if="isWuhen"> 		<h4>温馨提示</h4> 		<p>为了您良好的体验，请不要使用无痕或者隐私模式浏览网站，谢谢。退出无痕模式重新访问即可。</p> 		</div>',replace:!0}}).directive("noapp",["Constant","$timeout",function(e,o){return{restrict:"E",template:'		<div id="appkey" ng-if="showNotConnectApp">		<div id="hintbox">		<h4>温馨提示</h4>		<div class="smile">		<svg xmlns="http://www.w3.org/2000/svg" version="1.1">		 	<circle cx="25" cy="20" r="10" stroke="gray" stroke-width="2" fill="gray" />		  	<circle cx="75" cy="20" r="10" stroke="gray" stroke-width="2" fill="gray" />			<ellipse cx="50" cy="60" rx="15" ry="20" style="fill:white;stroke:gray;stroke-width:2" />		</svg>		</div>		<h5>未检测到钥匙,请打开钥匙</h5>		<p>若重复提示,请手动关闭钥匙再打开</p>		<div class="appkey_btn">			<button type="button" ng-click="closeAppKeyBox()">打开钥匙</button>			<p>若钥匙打开无效或闪退,请重新<span ng-click="downNewApp()">下载新版钥匙</span></p>		</div>		</div>		</div>',link:function(t){t.closeAppKeyBox=function(){t.showNotConnectApp=!1,window.location.href=e.ozScheme,o(function(){window.location.reload()},1e4)},t.downNewApp=function(){window.location.href=e.plistAdd}},replace:!0}}]).directive("ios9seting",[function(){return{restrict:"E",template:'		<div class="ios9seting" ng-show="showIos9Seting" ng-click="ios9Close(1,$event)">		<div class="ios9-box" ng-click="ios9Close(2,$event)">		<div class="ios9-title">			ios9小伙伴注意了		</div>		<div class="ios9-close" ng-click="ios9Close(1,$event)">x</div>		<div class="ios9-explain">		偶赚App是一款企业级应用,需要信任企业帐号才能使用,<b style="color:red;">安装完成后</b>请按下面步骤操作:		</div>		<div class="ios9-explain-bold">		设置-->通用-->描述文件与设备管理-->找到AURA打头的企业级应用-->进入后信任即可打开偶赚。		</div>		<div class="ios9-explain-to-seting">直接去设置:(信任后才能在桌面打开偶赚)</div>		<div class="ios9-toSeting" >			<div class="install" ng-click="ios9ToSeting()" id="install" ng-class="{true:\'isInstall\'}[!isInstall]"><div ng-bind="installText"></div></div>		</div>		</div>		</div>',link:function(e){e.ios9Close=function(o,t){t.stopPropagation(),2!=o&&(e.showIos9Seting=!1)}},replace:!0}}]).directive("bindwx",["Constant","tools",function(e,o){return{restrict:"E",template:'		<div class="bind-wx-container" ng-if="showWxBind">		<div class="bind_wx_title_bar">			<div class="main-box-back" ng-click="closeBindBox()">				<i class="iconfont">&#xe614;</i>			</div>			<div class="bind-wx-title" >绑定微信</div>		</div>		<div class="bind-wx-content-container">			<div class="bind-wx-item1">1、请使用微信搜索关注[偶赚]公众号！关注后点击[绑定微信]菜单即可自动绑定。</div>			<div class="bind-wx-keyword" oncopy="onCopyWx()" id="cashCopyKey">			偶赚			</div>			<div class="bind-wx-item1">2、也可以截屏保存到相册，在微信中扫一扫中选择从相册中选取二维码进行关注！关注后点击[绑定微信]菜单即可自动绑定。</div>			<div class="bind-wx-qrcode">			<img src="http://cdn.ozhuan.com/ozhuan/img/ozqrcode2.jpg" alt="偶赚">			</div>			<div class="bind-wx-towx" ng-click="toWeiXin()">打开微信</div>		</div>	</div>',link:function(t,n,a){!function(){window.onCopyWx=function(){o.getLocalStorage("bindwx")&&o.removeStorageItem("bindwx"),location.href=e.safariToWx},document.addEventListener("selectionchange",function(e){if("cashCopyKey"==window.getSelection().anchorNode.parentNode.id&&document.getElementById("cashCopyKey").innerText!=window.getSelection()){var o=document.getElementById("cashCopyKey");window.getSelection().selectAllChildren(o)}},!1)}(),t.toWeiXin=function(){o.getLocalStorage("bindwx")&&o.removeStorageItem("bindwx"),location.href=e.safariToWx},t.closeBindBox=function(){o.getLocalStorage("bindwx")&&o.removeStorageItem("bindwx"),t.showWxBind=!1}},replace:!0}}]).directive("bindmobile",function(){return{restrict:"E",template:'		<div class="bind-phone-container" ng-if="showPhoneBind"><div>		<div class="main-box-back" ng-click="closePhoneBindBox()">			<i class="iconfont">&#xe614;</i>		</div>		<div class="bind-phone-title" >绑定手机</div>		</div>		<div class="bind-phone-content-container">			<div class="bind-phone-item1">				<input type="tel"  placeholder="输入11位手机号" maxlength="11" ng-model="phoneObj.phoneNum">				<button type="button" ng-click="sendCode()" ng-bind="sendText" ng-disabled="disableSend" ng-class="{true:\'bind-phone-item1-disabled\'}[disableSend]">发送验证码</button>			</div>			<div class="bind-phone-item2">			<input type="tel" placeholder="输入5位验证码" maxlength="5" ng-model="phoneObj.codeNum">			</div>			<button class="bind-phone-item3" ng-click="commitPhone()" ng-disabled="!phoneObj.codeNum || !phoneObj.phoneNum" ng-class="{true: \'bind-phone-item3-disabled\'}[!phoneObj.codeNum || !phoneObj.phoneNum]">确定</button>			<div ng-show="!phoneObj.phoneNum" class="bind-phone-tips">请输入11位手机号</div>			<div ng-show="!phoneObj.codeNum" class="bind-phone-tips">请输入5位验证码</div>		</div></div>',link:function(e){e.closePhoneBindBox=function(){e.showPhoneBind=!1}},replace:!0}}).directive("showzhuanloading",function(){return{restrict:"E",template:'		<div class="zhuan_fixed" ng-if="ShowZhuanLoad">		<div class="zhuan_box">			<div class="zhuan_svg">				<svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"					viewBox="0 0 50 50" style="enable-background:new 0 0 50 50;" xml:space="preserve">				<g id="XMLID_2_">				<path id="XMLID_3_" fill="#f8f8f8" d="M19.6,12.4l-5.6,27H9.7L12,27.9h-1.8V7.6h12.7v20.3h-3.2V10.1h-6.3v11.4l2-9.1H19.6z M23,39.4h-4.4				l-2.3-10.5h4.4L23,39.4z M26.7,24.8l-0.8,14.6h-2.7L24,24.8H26.7z M42.4,11.3h-5.1v1.5h3.9V17h1.1v2.5h-1.1v4.1h-3.9v15.8H33V23.6				h-1.4v15.8h-4.2V23.6h-3.2v-2.5h3.2v-1.5h-3.8V17h3.8v-1.7h-3.2v-2.5h3.2v-1.5h-3.8V8.6h18.8V11.3z M31.5,8.2h-5.3l5.3-2.5V8.2z				M33,12.8v-1.5h-1.4v1.5H33z M33,17v-1.7h-1.4V17H33z M33,21.1v-1.5h-1.4v1.5H33z M39.9,8.2h-5.3l5.3-2.5V8.2z M38.5,15.3h-1.1V17				h1.1V15.3z M38.5,21.1v-1.5h-1.1v1.5H38.5z M42.4,39.4h-3.5l-1.3-14.6H41L42.4,39.4z"/>				</g>				</svg>			</div>			<div class="zhuan_desc" ng-bind="zhuanLoadText">正在加载</div>			<div class="zhuan_loading">				<span></span>				<span></span>				<span></span>			</div>		</div>	</div>		',link:function(e){e.zhuanLoadText="正在抢任务"},replace:!0}}),angular.module("ozApp.filter",[]).filter("fenToYuan",["tools",function(e){return function(o){var t=o/100;return t=t.toFixed(2),isNaN(t)&&(t=0),t=parseFloat(t),t=e.toDecimal2(t)}}]).filter("fenToYuanHalve",["tools",function(e){return function(o){var t=.8*o/100;return t=t.toFixed(2),t=parseFloat(t),isNaN(t)&&(t=0),t=e.toDecimal2(t)}}]).filter("toLocalTime",[function(){return function(e){var o=new Date(1e3*parseInt(e)).toLocaleString().replace(/年|月/g,"-").replace(/日/g," ").replace(/GMT\+8/," ");return o}}]),angular.module("ozApp.Http",[]).service("httpService",["$http",function(e){return{commonPost:function(o,t,n){e.post(o,t).success(function(e){n(e)}).error(function(){n({code:-1})})},commonGet:function(o,t){e.get(o).success(function(e){t(e)}).error(function(){t({code:-1})})}}}]),angular.module("ozApp.Task",[]).service("Task",["Constant","httpService","MyWebSock","Auth","tools",function(e,o,t,n,a){function i(e,o){function a(e){0==e.data.code?o(0,e.data.msg):e.data.code?o(e.data.code,e.data.msg):o(1,e.data.msg)}t.Reg("startTask",a);var i={cmd:"startTask",v:"v1.0",data:{sid:n.userInfo.get("sid")||"0",uid:n.userInfo.get("uid")||0,token:n.userInfo.get("base").token||"0",taskId:e.taskId,prj_name:e.prj_name,bundle_id:e.bundle_id,appid:e.appid,CheckInstalledUrl:e.CheckInstalledUrl,timeout:e.timeout,runTargetAppTime:e.runTargetAppTime}},s=angular.toJson(i);console.log("startTask = ",s),t.sendData(s)}function s(e,o){function a(e){o(e)}t.Reg("checkTask",a);var i={cmd:"checkTask",v:"v1.0",data:{sid:n.userInfo.get("sid"),uid:n.userInfo.get("uid"),taskId:e}},s=angular.toJson(i);t.sendData(s)}function r(e){function o(o){e(o)}t.Reg("get3rdDouJin",o);var n={cmd:"get3rdDouJin",v:"v1.0",data:{}},a=angular.toJson(n);t.sendData(a)}function c(e,o){function n(e){o(e)}t.Reg("start3rdDouJinTask",n);var a={cmd:"start3rdDouJinTask",v:"v1.0",data:{douJstoreID:e}},i=angular.toJson(a);t.sendData(i)}function l(e,o){function n(e){o(e)}t.Reg("giveUp3rdDouJinTask",n);var a={cmd:"giveUp3rdDouJinTask",v:"v1.0",data:{douJstoreID:e}},i=angular.toJson(a);t.sendData(i)}function d(e){var o={cmd:"launchSafariUrl",v:"v1.0",data:{url:e}},n=angular.toJson(o);t.sendData(n)}function u(e,o,n,a){var i="shareUrlToHY";i=1==e?"shareUrlToHY":"shareUrlToPYQ";var s={cmd:"share",v:"v1.0",data:{action:i,text:o||"",title:n||"",desc:a||""}},r=angular.toJson(s);t.sendData(r)}function p(e){function o(o){e(o)}var n={cmd:"getAppVersion",v:"v1.0",data:{}},a=angular.toJson(n);t.sendData(a),t.Reg("getAppVersion",o)}function h(e,o){function n(e){o(e)}var a={cmd:"getTaskState",v:"v1.0",data:{taskId:e}},i=angular.toJson(a);t.sendData(i),t.Reg("getTaskState",n)}function f(e,o){function n(e){o(e)}var a={cmd:"giveUpOwnTask",v:"v1.0",data:{taskId:e}},i=angular.toJson(a);t.sendData(i),t.Reg("giveUpOwnTask",n)}function m(e){function o(o){e(o)}var n={cmd:"getPushDc",v:"v1.0",data:{}},a=angular.toJson(n);t.sendData(a),t.Reg("getPushDc",o)}return{startTask:i,checkTask:s,getTask3rdList:r,start3rdTask:c,giveUp3rdTask:l,openUrlUseSafari:d,shareToWx:u,getAppVersion:p,getTaskState:h,giveUpOwnTask:f,getPushDc:m}}]),angular.module("ozApp.tools",[]).factory("tools",["$rootScope","$timeout","Constant",function(e,o,t){function n(e){var o,t=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(o=document.cookie.match(t))?unescape(o[2]):null}function a(e,o){var t=30,n=new Date;n.setTime(n.getTime()+24*t*60*60*1e3),document.cookie=e+"="+escape(o)+";expires="+n.toGMTString()}function i(e){var o=-1,t=new Date;t.setTime(t.getTime()+24*o*60*60*1e3),document.cookie=e+"=;expires="+t.toGMTString()}function s(e){for(var o=[],t={},n=0;n<e.length;n++){var a=e[n].Title,i=e[n],s=a;1!==t[s]&&(o.push(i),t[s]=1)}return o}function r(e){return Math.floor(Math.random()*e)}function c(t,n){e.ShowLoading&&(e.ShowLoading=!1),e.loadText=n,e.ShowLoading=!0,o(function(){e.ShowLoading=!1,e.loadText="加载中..."},t)}function l(){return navigator.userAgent.match(/MicroMessenger/i)?!0:!1}function d(){return navigator.userAgent.match(/QQ/i)?!0:!1}function u(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)?navigator.userAgent.match(/OS [9]_\d[_\d]* like Mac OS X/i)?9:navigator.userAgent.match(/OS [5]_\d[_\d]* like Mac OS X/i)?5:navigator.userAgent.match(/OS [6]_\d[_\d]* like Mac OS X/i)?6:navigator.userAgent.match(/OS [7]_\d[_\d]* like Mac OS X/i)?7:navigator.userAgent.match(/OS [8]_\d[_\d]* like Mac OS X/i)?8:navigator.userAgent.match(/OS [10]_\d[_\d]* like Mac OS X/i)?10:88:77}function p(){try{return localStorage.setItem("test","testdata"),!1}catch(e){return!0}}function h(e){var o=parseFloat(e);if(isNaN(o))return!1;var o=Math.round(100*e)/100,t=o.toString(),n=t.indexOf(".");for(0>n&&(n=t.length,t+=".");t.length<=n+2;)t+="0";return t}function f(e){if(!e)return 300;var o=new RegExp(/M/gi),n=parseInt(e.replace(o,"")),a=n*t.runAppTimeOut*60;return 300>a?a=300:a>3600&&(a=3600),a}function m(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),t=window.location.search.substr(1).match(o);return null!=t?unescape(t[2]):null}var g={getRandNum:r,setCookie:a,getCookie:n,clearCookie:i,removeStorage:function(){localStorage.clear()},removeStorageItem:function(e){localStorage.removeItem(e)},toLocalStorage:function(e,o){localStorage.setItem(e,o)},getLocalStorage:function(e){return localStorage.getItem(e)},showTips:c,emitMsg:function(o,t){var t=t||{};e.$emit(o,t)},onMsg:function(o,t,n){var a=e.$on(o,t);n&&n.$on("$destroy",a)},arrayUnique:s,isWeixin:l,isQQ:d,iOSVersion:u,isWuHen:p,toDecimal2:h,appSizeToTime:f,GetQueryString:m};return g}]),angular.module("ozApp.Websocket",[]).service("MyWebSock",["$rootScope","Constant","$timeout","tools",function(e,o,t,n){function a(e){m=t(function(){u()},3e3),f=new WebSocket(e),f.onopen=i,f.onmessage=s,f.onerror=r,f.onclose=c}function i(){w=!0,e.$apply(function(){e.showNotConnectApp&&(e.showNotConnectApp=!1,n.showTips(2e3,"已正常连接钥匙,现在可以做任务啦"))}),m&&t.cancel(m)}function s(e){g&&t.cancel(g);var o=angular.fromJson(e.data),n=v[o.cmd];n&&n(o)}function r(){w=!1,m&&t.cancel(m)}function c(){w=!1,k&&t(function(){h()},2e3)}function l(e,o){v[e]=o}function d(o){return 1!=f.readyState?(u(),n.emitMsg("ozAppIsNoReady","YES"),void(e.showNotConnectApp=!0)):(g&&t.cancel(g),g=t(function(){n.emitMsg("sendMsgTimeout","YES")},15e3),void f.send(o))}function u(){f.close()}function p(){return w}function h(){if(w)u(),h();else{if(!window.WebSocket)return void alert("浏览器版本太低，不支持websocket,无法进行正常任务!");a(o.webSockUrl)}}var f,m,g,v={},w=!1,k=o.webSockRe;return{Reg:l,webSockStatus:p,sendData:d,Close:u,startWebsock:h}}]);